---
id: TASK-2025-005
title: "Фаза 4. RAG MCP — методологии и гайды"
status: backlog
priority: medium
type: feature
estimate: 24h
assignee: @unassigned
created: 2025-12-09
updated: 2025-12-09
arch_refs: [ARCH-agent-moex-market-analyst]
risk: medium
benefit: "Добавляет текстовый контекст (методики, регламенты, шаблоны отчётов) для пояснений и обоснований в ответах агента."
audit_log:
  - {date: 2025-12-09, user: "@AI-DocArchitect", action: "created with status backlog"}
---

## Описание

Собрать корпус методологических и регуляторных документов и реализовать отдельный RAG MCP с инструментом `rag_search`, интегрировать его в планировщик и формирователь ответа агента для сценариев «объясни/расскажи».

## Критерии приемки

- Сформирован корпус из 20–40 документов в каталоге `rag_corpus/` (методики МОEX/ЦБ по индексам и волатильности, гайды по риск-менеджменту, шаблоны отчётов инвесткомитетов).
- Реализован RAG MCP с чанкингом 500–1000 токенов и overlap 10–15%, индексом (FAISS или аналогом) и инструментом `rag_search(query: str, top_k: int=5)`.
- Интеграционный тест показывает, что запрос вроде «что такое волатильность» возвращает релевантные сниппеты из методических документов.
- `Planner` добавляет шаги `rag_search` для запросов «объясни/расскажи», а `ResponseFormatter` вставляет выдержки и ссылки в итоговый текст.

## Определение готовности

- Запросы на объяснение показателей (доходность, волатильность, риск) обогащаются выдержками из методических документов.
- RAG MCP стабильно работает в тех же окружениях, что и основной MCP/агент, с наблюдаемостью и понятной обработкой ошибок.
- Корпус документов задокументирован (источники, формат, периодичность обновления).

## Заметки

Эта задача агрегирует подпункты 4.1–4.3 плана архитектора (Фаза 4).

