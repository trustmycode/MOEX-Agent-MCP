---
id: TASK-2025-034
title: "Фаза 4.2. RAG MCP и tool rag_search"
status: backlog
priority: medium
type: feature
estimate: 16h
assignee: @unassigned
created: 2025-12-09
updated: 2025-12-09
parents: [TASK-2025-005]
arch_refs: [ARCH-agent-moex-market-analyst]
risk: medium
benefit: "Добавляет отдельный RAG MCP для работы с текстовым корпусом методологий."
audit_log:
  - {date: 2025-12-09, user: "@AI-DocArchitect", action: "created with status backlog"}
---

## Описание

Реализовать RAG MCP с индексом поверх подготовленного корпуса, настроить чанкинг и инструмент `rag_search(query: str, top_k: int=5)`, возвращающий релевантные сниппеты.

## Критерии приемки

- Выбран и реализован механизм индексации (FAISS или аналог), настроен чанкинг 500–1000 токенов с overlap 10–15%.
- MCP предоставляет инструмент `rag_search`, который:
  - принимает строковый запрос и `top_k`;
  - возвращает список результатов `{title, snippet, source, url}`.
- Интеграционный тест показывает, что запрос «что такое волатильность» возвращает выдержки из методических документов, а не произвольные тексты.

## Определение готовности

- Агент может подключить RAG MCP как внешний источник пояснений по показателям и методикам.

## Заметки

Соответствует пункту 4.2 плана архитектора (Фаза 4).

