# TASK-2025-102: Источник фундаментальных и CFO-данных на базе MOEX ISS (`FundamentalsDataProvider`)

## Статус

- Статус: done
- Приоритет: P0
- Компонент: risk-analytics-mcp
- Связанные сценарии: issuer_peers_compare (5), portfolio_risk (7), cfo_liquidity_report (9)

## Контекст

Для сценариев 5/7/9 нужны базовые фундаментальные и CFO-метрики (выручка, EBITDA, долг, маржа, мультипликаторы). Для MVP источник данных — MOEX ISS, при этом архитектурно должен быть сохранён интерфейс, позволяющий заменить источник на коммерческий API после хакатона.

## Цель

Сделать внутри `risk-analytics-mcp` абстракцию `FundamentalsDataProvider` и реализовать MOEX-ориентированную реализацию, достаточную для расчёта ключевых метрик и мультипликаторов.

## Объём работ

### In scope

- Определение интерфейса `FundamentalsDataProvider`:
  - методы получения базовых отчётных показателей по тикеру/эмитенту,
  - методы получения базовых рыночных данных (цена, капитализация, free-float).
- Реализация `MoexIssFundamentalsProvider`:
  - запросы к MOEX ISS по тикерам,
  - маппинг в унифицированные доменные модели (Pydantic).
- Набор метрик, гарантированно доступный в MVP:
  - выручка, EBITDA/EBIT, чистая прибыль,
  - долг, долг/EBITDA,
  - P/E, EV/EBITDA, дивидендная доходность (если данные доступны).
- Кэширование/ограничение частоты запросов (простая LRU или in-memory кэш на время жизни процесса).
- Юнит-тесты на основе сохранённых JSON-ответов MOEX (snapshot-файлы).

### Out of scope

- Поддержка нескольких внешних провайдеров одновременно.
- Сложная нормализация отчётности (MSFO vs РСБУ) — только базовый маппинг, достаточный для демо.

## Acceptance Criteria

- [x] Существует интерфейс `FundamentalsDataProvider` с чётко определёнными методами.
- [x] Реализован класс `MoexIssFundamentalsProvider`, возвращающий стабильные доменные модели для выбранных тикеров.
- [x] Все сценарии, использующие фундаментал (5/7/9), работают через этот интерфейс, а не напрямую через MOEX ISS.
- [x] Написано минимум 2 unit-теста, использующих сохранённые ответы MOEX ISS.
- [x] В документации MCP описано, какие именно метрики гарантированно доступны из `FundamentalsDataProvider` в MVP.
