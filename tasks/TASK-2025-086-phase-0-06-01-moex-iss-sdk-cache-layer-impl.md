---
id: TASK-2025-086
title: "Фаза 0.6.1. Реализация LRU-кэша в moex_iss_sdk"
status: done
priority: high
type: feature
estimate: 6h
assignee: @unassigned
created: 2025-12-10
updated: 2025-12-10
parents: [TASK-2025-075]
arch_refs: [ARCH-sdk-moex-iss, ARCH-mcp-moex-iss]
risk: medium
benefit: "Уменьшает количество обращений к MOEX ISS за счёт кэширования типовых запросов в слое SDK."
audit_log:
  - {date: 2025-12-10, user: "@AI-DocArchitect", action: "created with status backlog"}
---

## Описание

Реализовать LRU-кэш с конфигурируемым TTL в `moex_iss_sdk` и встроить
его в методы `IssClient` для идемпотентных запросов (snapshot, индексные
маппинги, короткие интервалы истории).

Поведение кэша должно управляться параметрами `ENABLE_CACHE` и
`CACHE_TTL_SECONDS` (через конфиг/ENV).

## Критерии приемки

- В SDK реализован кэширующий слой (отдельный модуль или обёртка),
  поддерживающий:
  - ограниченный размер кэша (по количеству ключей);
  - TTL для записей;
  - прозрачную интеграцию с `IssClient`.
- Методы `IssClient`, помеченные как идемпотентные, используют кэш
  (при `ENABLE_CACHE=true`), а при `ENABLE_CACHE=false` работают как
  прямой прокси к HTTP-клиенту.
- Добавлены unit-тесты, проверяющие:
  - попадание/промах кэша;
  - истечение TTL;
  - корректную работу при отключённом кэше.

## Определение готовности

- На нагрузочных/повторных сценариях число реальных HTTP-запросов к ISS
  снижается за счёт кэширования, без изменения внешнего поведения MCP.

## Заметки

- Детали политики вытеснения (объём кэша) могут быть вынесены в конфиг
  и уточнены позже на основе наблюдаемости.
