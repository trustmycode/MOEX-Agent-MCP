---
id: TASK-2025-010
title: "Фаза 0.2. Поведение по датам и глубине истории"
status: backlog
priority: high
type: chore
estimate: 4h
assignee: @unassigned
created: 2025-12-09
updated: 2025-12-09
parents: [TASK-2025-001]
arch_refs: [ARCH-mcp-moex-iss, ARCH-agent-moex-market-analyst]
risk: low
benefit: "Фиксирует единые правила по диапазонам дат и ограничению глубины истории для контроля нагрузки на ISS."
audit_log:
  - {date: 2025-12-09, user: "@AI-DocArchitect", action: "created with status backlog"}
---

## Описание

Формализовать в REQUIREMENTS и SPEC поведение по умолчанию для дат запросов к MOEX ISS, а также максимальную глубину истории и ошибку при её превышении.

## Критерии приемки

- В REQUIREMENTS/SPEC описано, что по умолчанию:
  - `to_date = today`;
  - `from_date = to_date - 365 дней`.
- Задано ограничение `MAX_LOOKBACK_DAYS = 730` и его назначение (контроль нагрузки и скорости ответа).
- Описано поведение при превышении лимита: MCP возвращает нормализованную ошибку с `error_type = "DATE_RANGE_TOO_LARGE"`.
- В REQUIREMENTS есть рекомендация пользователю/агенту сужать период при получении этой ошибки.

## Определение готовности

- Документация однозначно определяет дефолтные даты, лимит глубины истории и формат ошибки.
- В дальнейшем при реализации MCP и агента разработчики могут опираться на эти правила без дополнительных согласований.

## Заметки

Содержимое задачи соответствует пункту 0.2 плана архитектора (Фаза 0).

