---
id: TASK-2025-011
title: "Фаза 0.3. Спецификация индексов и кэширования"
status: done
priority: high
type: chore
estimate: 4h
assignee: @unassigned
created: 2025-12-09
updated: 2025-12-09
parents: [TASK-2025-001]
arch_refs: [ARCH-mcp-moex-iss]
risk: low
benefit: "Определяет поведение MCP при работе с индексами, их маппинг и кэширование."
audit_log:
  - {date: 2025-12-09, user: "@AI-DocArchitect", action: "created with status backlog"}
---

## Описание

Уточнить в SPEC поведение инструментов MCP, работающих с индексами: способ маппинга `index_ticker → indexid` через ISS, параметры кэширования и формат ошибки при неизвестном индексе.

## Критерии приемки

- В SPEC добавлен раздел для `get_index_constituents_metrics` (и других индексных инструментов), описывающий:
  - маппинг тикера индекса к его внутреннему идентификатору ISS;
  - использование кэша результатов маппинга с TTL ~24 часа;
  - поведение при отсутствии индекса или ошибке маппинга.
- Определена и задокументирована ошибка `UNKNOWN_INDEX` с примером значения `error_type` и полями `message`/`details`.
- В описании MCP чётко указано, когда обновляется кэш и при каких условиях он инвалидируется.

## Определение готовности

- Документация SPEC даёт однозначное понимание, как MCP обрабатывает индексные тикеры и кэширует результаты.
- Команда разработки MCP подтверждает, что требований достаточно для реализации и тестирования.

## Заметки

Задача отражает пункт 0.3 плана архитектора (Фаза 0).

